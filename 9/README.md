# Канали (pipes)

Употреба на системното извикване `pipe(2)`.

## `pipe(2)`

    #include <unistd.h>

    int pipe(int fd[2]);

Системното извикване `pipe()` създава канал (*pipe*) за междупроцесна комуникация (*IPC*) между два процеса.  Каналът може да се интерпретира като специален вид файл, в който единият процес може да само да пише, а другият - само да чете от него.  Данните, които записва единият процес откъм края за писане на канала се буферират, докато не бъдат прочетени откъм края за четене на канала от другия процес.

Аргументът `fd` е двуелементен масив, който се използва, за да се "върнат" от `pipe()` двата файлови дескриптора, чрез които се дефинират двата края на канала.  `fd[0]` се използва за достъп до четящия край на канала, а `fd[1]` - за достъп до пишещия край.

При изчерпване на данните за четене от страна на четящия процес той блокира в системното извикване `read(2)`, докато не бъдат записани нови данни от пишещия процес.  При завършване на пишещия процес преди четящия `read(2)` приключва успешно в четящия процес.  При завършване на четящия процес преди пишещия, на пишещия процес се изпраща сигнал `SIGPIPE` и той завършва изпълнението си с грешка (тъй като няма на кого да пише).

`pipe()` връща стойност `0` при успешно изпълнение на операцията или `-1` в противен случай.

`pipe()` може да се използва за реализацията на механизма `|` (*pipe*) в командните интерпретатори.

## Задачи

Да се реализират следните команди чрез канали между съответните процеси (`argv[i]` е *i*-тият команден аргумент на програмата, а `argv[i..]` са всички командни аргументи от *i*-тия натам):

1. `who | wc -l`
2. `ls | wc -l`
3. `grep argv[1..] | wc -l`
4. `head -n argv[1] argv[3..] | grep argv[2] | wc -l`
5. `grep argv[1..] | sort | uniq | wc -l`
6. (*незадължителна*) `argv[1] | argv[2] | ... | argv[N]`

Програмите, реализиращи каналите, трябва да връщат изходния код на последния процес от канала.